# 产品详细需求文档

## 1.1 用药管理（核心功能 / 第一阶段必须完成）

包含：计划、周期、打卡/补记、药品说明。

### A) 用药计划（`plan-list` / `plan-edit` / `plan-detail`）

#### 功能点

1. **新建计划字段**：
   - 药品名称
   - 剂量
   - 服用时间（每天可多次）
   - 开始/结束日期
   - 重复周期：每日 / 每周特定几天

2. **计划状态与校验规则（前后端一致）**：
   - `name` 必填，长度 1–50
   - `dosage` 必填（如“1片/10毫升”）
   - `times` 至少 1 个，格式 `HH:mm`，支持多个
   - `startDate <= endDate`
   - `repeatType = daily | weekly`
     - `daily`：无需传 `repeatDays`（后端可按全周处理）
     - `weekly`：`repeatDays` 必须至少 1 个，取值 0–6（周日=0）

3. **计划详情页支持**：
   - 查看计划字段

---

### B) 今日用药打卡（`today-checkin`）

老人点击“已服用”，系统记录；漏服可补记或标记“未服”。

#### 产品行为

1. 进入“今日用药”，展示当天所有“应服点位”（由计划 × 日期 × 时间生成）
2. 每个点位有 3 种状态：
   - `todo`（待打卡）
   - `taken`（已服用）
   - `missed`（未服）
3. 点击“已服用/未服”立即落库并更新状态
4. 点“补记/更正”跳转至 `record-adjust`

> **关键决策**：  
> `records` 是“点位记录表”（不是日志流水），即：同一个 `plan + date + time` 只能有 1 条记录（便于统计是否按时服药）。

---

### C) 用药记录列表（`record-list`）

- 支持按：计划 / 状态 / 日期区间过滤
- 记录展示字段：
  - 计划名
  - 计划时间点
  - 状态
  - 实际操作时间
  - 备注
- 每条记录可进入“补记/更正”

---

### D) 补记/更正（`record-adjust`）

- 可将任意 record 的 `status` 改为 `taken` / `missed`
- 可填写 `actionAt`（实际操作时间）和 `note`（备注）
- **典型场景**：老人忘记打卡，家属或老人后补一条“已服用”

---

### E) 药品清单与说明（drug catalog）

- 内置常见药品数据库
- 点击可查看通俗说明（非医疗建议，仅参考）
- **前端当前还没有对应页面**，但接口 / 数据结构需先定义好

---
1.2 功能衔接页面需求说明
A） 功能概述
为优化系统结构与用户体验，在用户登录成功后、进入用药计划管理模块之前，
系统新增一个功能衔接页面，用于统一承载系统功能入口。
该页面作为登录与核心业务功能之间的过渡页面，
帮助用户理解系统功能定位并自主选择后续操作。

B) 页面位置与访问方式
页面访问时机：用户登录成功后自动进入
页面作用位置：
登录页面 → 功能衔接页面 → 具体功能模块

C) 页面功能说明
功能衔接页面需具备以下功能：
展示系统整体目标与健康管理理念
提供系统主要功能入口，包括：
用药计划管理
健康知识（SDG3）
用户可根据自身需求，从该页面进入对应功能模块。

D) 业务流程说明
用户访问系统
   ↓
完成登录认证
   ↓
进入功能衔接页面
   ↓
用户选择功能入口
   ├─ 进入用药计划管理模块
   └─ 进入健康知识（SDG3）模块

E) 设计原则说明
页面结构简洁清晰，避免复杂操作
功能入口语义明确，便于理解
不涉及用户数据修改，仅作为导航与引导页面

1.3 健康知识模块（SDG3）需求说明
A) 模块背景与目标
健康知识模块用于向用户展示与健康管理、合理用药相关的科普内容，
同时响应联合国可持续发展目标 SDG3：健康与福祉。
该模块作为系统的辅助功能模块，
用于提升用户健康意识与科学用药认知。

B) 功能定位
模块类型：信息展示类功能
功能性质：健康科普与知识传播
不涉及在线医疗诊断或个性化治疗建议

C) 功能需求说明
健康知识模块应具备以下功能：
展示健康知识文章列表
支持用户浏览文章内容
文章内容包括但不限于：
SDG3 的背景与目标说明
合理用药的重要性
健康生活方式与日常管理建议

D) 内容规范要求
文章内容需使用通俗易懂的语言
内容以健康科普为目的
页面需明确标注免责声明，提示内容不构成医疗建议

E) 与系统其他模块的关系
健康知识模块不依赖用药计划数据
作为功能衔接页面中的可选入口之一
不影响系统原有核心业务流程

## 1.4 其他模块（第二阶段：先定需求+接口，后续加页面）

### AI 健康对话助手

- 支持文本 / 语音提问
- 常见问题快捷入口
- 规避医疗建议，提示“请咨询医生”
- 上下文记忆最近 3 轮
- 语音功能：
  - 录音：`wx.startRecord`
  - 语音识别：`wx.translateVoice`
  - TTS 播报

---

### 紧急联系人一键呼叫

- 设置 1~2 位紧急联系人
- 主页显眼按钮
- 点击直接拨号：`wx.makePhoneCall`

---

### 健康文章

- 内置适老化文章库
- 支持分类、详情页

---

### 家属远程查看（可选绑定）

- 老人生成"家庭码"，家属扫码绑定（手机号 / openid）
- 家属端可查看：
  - 用药打卡
  - AI 对话历史
- **仅展示老人授权的内容**